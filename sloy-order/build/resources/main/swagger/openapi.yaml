openapi: "3.0.0"
info:
  title: webSloy
  version: "0.0.1"
servers:
  - url: http://localhost:8080/api/v1
tags:
  - name: Order
  - name: Catalog
  - name: User
  - name: AvaliableTimes
paths:
  /сatalog:
    get:
      operationId: getCatalog
      tags:
        - Catalog
      responses:
        '200':
          description: Успех
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: "#/components/schemas/Catalog"
        '400':
          description: Чё то пошло не так
          content:
            application/json;charset=UTF-8:
              schema:
                type: string


    post:
      operationId: addItem
      tags:
        - Catalog
      requestBody:
        required: true
        content:
          application/json;charset=UTF-8:
            schema:
              $ref: "#/components/schemas/RawItem"
      responses:
        '200':
          description: Успех, возвращаем присвоенный itemId
          content:
            application/json;charset=UTF-8:
              schema:
                type: integer
        '400':
          description: Чё то пошло не так
          content:
            application/json;charset=UTF-8:
              schema:
                type: string
  /catalog/{id}:
    delete:
      operationId: deleteItemById
      tags:
        - Catalog
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Успех
        '400':
          description: Чё то пошло не так
          content:
            application/json;charset=UTF-8:
              schema:
                type: string


  /avaliableTimes:
    get:
      operationId: getAvaliableTimes
      tags:
        - AvaliableTimes
      responses:
        '200':
          description: Успех
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: "#/components/schemas/AvaliableTimes"
        '400':
          description: Чё то пошло не так
          content:
            application/json;charset=UTF-8:
              schema:
                type: string

    post:
      operationId: postAvaliableTimes
      tags:
        - AvaliableTimes
      requestBody:
        required: true
        content:
          application/json;charset=UTF-8:
            schema:
              $ref: "#/components/schemas/AvaliableTimes"
      responses:
        '200':
          description: Успех
        '400':
          description: Чё то пошло не так
          content:
            application/json;charset=UTF-8:
              schema:
                type: string
  /order:
    post:
      operationId: addOrder
      tags:
        - Order
      requestBody:
        required: true
        content:
          application/json;charset=UTF-8:
            schema:
              $ref: "#/components/schemas/RawOrder"
      responses:
        '200':
          description: Успех, возвращаем orderId
          content:
            application/json;charset=UTF-8:
              schema:
                type: integer
        '400':
          description: Чё то пошло не так
          content:
            application/json;charset=UTF-8:
              schema:
                type: string
  /order/{id}:
    get:
      operationId: getOrderById
      tags:
        - Order
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Успех
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: "#/components/schemas/FullOrder"
        '400':
          description: Чё то пошло не так
          content:
            application/json;charset=UTF-8:
              schema:
                type: string

  /user/{id}:
    get:
      operationId: getUserById
      tags:
        - User
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Успех
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: "#/components/schemas/User"
        '400':
          description: Чё то пошло не так
          content:
            application/json;charset=UTF-8:
              schema:
                type: string



components:
  schemas:
    Item:
      type: object
      title: Item
      description: Позиция меню
      required:
        - itemName
        - itemId
        - itemCost
      properties:
        itemName:
          type: string
        itemId:
          type: integer
        itemCost:
          type: integer

    RawItem:
      type: object
      title: RawItem
      description: Позиция меню для её добавление в меню
      required:
        - itemName
        - itemCost
      properties:
        itemName:
          type: string
        itemCost:
          type: integer

    Catalog:
      type: object
      title: Catalog
      description: Меню
      required:
        - size
        - items
      properties:
        size:
          type: integer
        items:
          type: array
          items:
            $ref: '#/components/schemas/Item'

    RawOrder:
      type: object
      title: RawOrder
      description: Заказ без лишних полей для создания заказа и массивом пар <itemId, itemNumber>
      required:
        - time
        - userId
        - items
        - orderCost
        - comment
      properties:
        time:
          type: integer
        userId:
          type: integer
        items:
          type: array
          items:
            properties:
              itemId:
                type: integer
              itemNumber:
                type: integer
        orderCost:
          type: integer
        comment:
          type: string

    FullOrder:
      type: object
      title: FullOrder
      description: Заказ для хранения заказа c Массивом пар <item, itemNumber>
      required:
        - time
        - userId
        - orderId
        - items
        - orderCost
        - comment
        - status
      properties:
        time:
          type: integer
        userId:
          type: integer
        orderId:
          type: integer
        items:
          type: array
          items:
            properties:
              item:
                type: object
                items:
                  $ref: '#/components/schemas/Item'
              itemNumber:
                type: integer
        orderCost:
          type: integer
        comment:
          type: string
        status:
          type: string
          enum:
            - waiting for payment
            - paid and preparing
            - ready
            - received
            - cancelled

    User:
      type: object
      title: User
      description: Пользователь
      required:
        - userId
        - orders
      properties:
        user_id:
          type: integer
        orders:
          type: array
          items:
            $ref: '#/components/schemas/FullOrder'
    AvaliableTimes:
      type: object
      title: AvaliableTimes
      description: Доступные для заказа времена в секундах от начала дня
      required:
        - times
      properties:
        times:
          type: array
          items:
            type: integer
